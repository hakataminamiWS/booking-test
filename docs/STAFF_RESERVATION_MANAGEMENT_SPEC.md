# スタッフ予約管理機能仕様書

このドキュメントは、スタッフが自身の担当する予約を管理する機能のUI/UX、APIエンドポイント、およびデータインタラクションに関する詳細な仕様を定義します。

## 1. 目的

スタッフが効率的に自身の予約状況を確認し、管理できる共通認識を確立することを目的とします。

## 2. 対象ユーザー

-   Staff (店舗スタッフ)

## 3. 機能概要

スタッフが自身の担当する予約の閲覧、詳細確認、ステータス変更（確定、キャンセルなど）を行う機能を提供します。

## 4. 画面仕様詳細

### 4.1. スタッフ予約一覧画面

-   **URL**: `/shops/{shop_slug}/staff/bookings`
-   **UI要素**:
    *   検索フィルター (日付範囲、ステータス、顧客名など)
    *   ソート機能 (予約日時、顧客名など)
    *   ページネーション
    *   自身の担当する予約情報のリスト表示 (予約日時、顧客名、メニュー、ステータスなど)
    *   各予約の詳細画面へのリンク
-   **データフロー**:
    *   `GET /api/shops/{shop_slug}/staff/bookings` (スタッフ自身の予約のみ)
    *   レスポンス例: (予約一覧のJSON構造)

### 4.2. スタッフ予約詳細画面

-   **URL**: `/shops/{shop_slug}/staff/bookings/{booking_id}`
-   **UI要素**:
    *   予約情報の詳細表示 (顧客情報、予約日時、メニュー、ステータス、メモなど)
    *   ステータス変更ボタン (確定、キャンセルなど)
-   **データフロー**:
    *   `GET /api/shops/{shop_slug}/staff/bookings/{booking_id}`
    *   `PUT /api/shops/{shop_slug}/staff/bookings/{booking_id}` (ステータス変更)

## 5. API設計

### 5.1. スタッフ予約一覧取得

-   **エンドポイント**: `GET /api/shops/{shop_slug}/staff/bookings`
-   **クエリパラメータ**: フィルター、ソート、ページネーション関連
-   **レスポンス**: スタッフ自身の予約情報のリスト (JSON)

### 5.2. スタッフ予約詳細取得

-   **エンドポイント**: `GET /api/shops/{shop_slug}/staff/bookings/{booking_id}`
-   **レスポンス**: 単一の予約情報 (JSON)

### 5.3. スタッフ予約ステータス変更/更新

-   **エンドポイント**: `PUT /api/shops/{shop_slug}/staff/bookings/{booking_id}`
-   **リクエストボディ**: 変更する予約情報、またはステータス
-   **レスポンス**: 更新された予約情報 (JSON)

## 6. 認可 (Authorization)

-   Laravel Policy を利用し、スタッフが自身の担当する予約のみ操作できることを保証します。

## 7. データモデルとの関連

-   `Booking` モデル
-   `Shop` モデル
-   `User` モデル (Staff, Booker)
-   `Menu` モデル